<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุงูุชุญูู - ุฌูุนูุฉ ุงูุฃูู ุงูุฎูุฑูุฉ</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div class="dashboard">
        <header class="dashboard-header">
            <h1>ููุญุฉ ุงูุชุญูู ๐</h1>
            <nav>
                <a href="/dashboard" class="nav-link active">ููุญุฉ ุงูุชุญูู</a>
                <a href="/dashboard/add-event" class="nav-link">ุฅุถุงูุฉ ูุนุงููุฉ</a>
                <a href="/dashboard/add-partner" class="nav-link">ุฅุถุงูุฉ ุดุฑูู</a>
                <a href="/" class="nav-link">ุนุฑุถ ุงููููุน</a>
                <a href="/login/logout" class="nav-link" onclick="return confirmLogout()">ุชุณุฌูู ุงูุฎุฑูุฌ</a>
            </nav>
        </header>

        <main class="dashboard-main">
            <!-- ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ -->
            <section class="dashboard-stats">
                <div class="stat-card">
                    <h3>ุฅุฌูุงูู ุงููุนุงููุงุช</h3>
                    <div class="stat-number">24</div>
                    <p>ูุนุงููุฉ ุฎูุฑูุฉ</p>
                </div>
                
                <div class="stat-card">
                    <h3>ุงููุณุชููุฏูู</h3>
                    <div class="stat-number">1,250</div>
                    <p>ุดุฎุต ุงุณุชูุงุฏ</p>
                </div>
                
                <div class="stat-card">
                    <h3>ุงููุชุทูุนูู</h3>
                    <div class="stat-number">85</div>
                    <p>ูุชุทูุน ูุดุท</p>
                </div>
            </section>

            <!-- ุงูุฃูุดุทุฉ ุงูุญุฏูุซุฉ -->
            <section class="recent-activities">
                <h2>ุงูุฃูุดุทุฉ ุงูุญุฏูุซุฉ ๐</h2>
                <div class="activity-list">
                    <div class="activity-item">
                        <h4>ุชูุฒูุน ุงููุฌุจุงุช ุงูุบุฐุงุฆูุฉ ๐ฝ๏ธ</h4>
                        <p>ุชู ุชูุฒูุน 200 ูุฌุจุฉ ุณุงุฎูุฉ ุนูู ุงูุฃุณุฑ ุงููุญุชุงุฌุฉ ูู ุญู ุงูุฒูุฑุงุก. ุดุงุฑู ูู ูุฐู ุงููุนุงููุฉ 15 ูุชุทูุน.</p>
                        <span class="activity-date">15 ุฏูุณูุจุฑ 2023</span>
                    </div>
                    
                    <div class="activity-item">
                        <h4>ุญููุฉ ูุณูุฉ ุงูุดุชุงุก โ๏ธ</h4>
                        <p>ุชูุฒูุน 150 ูุทุนุฉ ููุงุจุณ ุดุชููุฉ ู 80 ุจุทุงููุฉ ุนูู ุงูุฃุทูุงู ูุงูุนุงุฆูุงุช ุงููุญุชุงุฌุฉ ุงุณุชุนุฏุงุฏุงู ููุตู ุงูุดุชุงุก.</p>
                        <span class="activity-date">1 ุฏูุณูุจุฑ 2023</span>
                    </div>
                    
                    <div class="activity-item">
                        <h4>ุจุฑูุงูุฌ ุงูุฏุนู ุงูุชุนูููู ๐</h4>
                        <p>ุชูุฒูุน 100 ุญููุจุฉ ูุฏุฑุณูุฉ ูุน ุงููุชุจ ูุงูุฃุฏูุงุช ุนูู ุงูุทูุงุจ ุงููุญุชุงุฌููุ ุจุงูุฅุถุงูุฉ ุฅูู ุชุณุฌูู 50 ุทุงูุจ ูู ุจุฑูุงูุฌ ุงูุชูููุฉ.</p>
                        <span class="activity-date">20 ููููุจุฑ 2023</span>
                    </div>
                    
                    <div class="activity-item">
                        <h4>ุงููุงููุฉ ุงูุทุจูุฉ ุงููุฌุงููุฉ ๐ฅ</h4>
                        <p>ูุญุต ุทุจู ูุฌุงูู ูู 180 ูุฑูุถ ูุน ุชูุฒูุน ุงูุฃุฏููุฉ ุงูุฃุณุงุณูุฉ. ุดุงุฑู ูู ุงููุงููุฉ 8 ุฃุทุจุงุก ู 12 ููุฑุถ.</p>
                        <span class="activity-date">10 ููููุจุฑ 2023</span>
                    </div>
                    
                    <div class="activity-item">
                        <h4>ููู ุชุฑูููู ููุฃูุชุงู ๐ถ</h4>
                        <p>ุชูุธูู ููู ุชุฑูููู ูู 60 ุทูู ูุชูู ุดูู ุงูุฃูุนุงุจ ูุงููุฏุงูุง ูุงููุฌุจุงุชุ ูุน ุชูุฒูุน ููุงุจุณ ุฌุฏูุฏุฉ ููู ุทูู.</p>
                        <span class="activity-date">5 ููููุจุฑ 2023</span>
                    </div>
                </div>
            </section>

            <!-- ุฑุณุงุฆู ุงููุฌุงุญ -->
            <div class="success-message" style="display: none;" id="successMessage">
                <p>โ ุชู ุญูุธ ุงูุจูุงูุงุช ุจูุฌุงุญ!</p>
            </div>
            <div class="success-message" style="display: none;" id="partnerSuccessMessage">
                <p>๐ค ุชู ุฅุถุงูุฉ ุงูุดุฑูู ุจูุฌุงุญ!</p>
            </div>
        </main>
    </div>

    <script>
        // Handle URL parameters for success messages
        const urlParams = new URLSearchParams(window.location.search);
        const success = urlParams.get('success');

        const successMessages = {
            'event_added': 'โ ุชู ุฅุถุงูุฉ ุงููุนุงููุฉ ุจูุฌุงุญ!',
            'partner_added': '๐ค ุชู ุฅุถุงูุฉ ุงูุดุฑูู ุจูุฌุงุญ!'
        };

        if (success && successMessages[success]) {
            const messageDiv = success === 'event_added' ?
                document.getElementById('successMessage') :
                document.getElementById('partnerSuccessMessage');
            
            if (messageDiv) {
                messageDiv.querySelector('p').textContent = successMessages[success];
                messageDiv.style.display = 'block';
                setTimeout(() => {
                    messageDiv.style.display = 'none';
                }, 5000);
            }
        }

        // Load dynamic statistics
        async function loadStatistics() {
            try {
                const response = await fetch('/dashboard/api/stats');
                const stats = await response.json();
                
                // Update statistics cards
                const statCards = document.querySelectorAll('.stat-card');
                if (statCards.length >= 3) {
                    statCards[0].querySelector('.stat-number').textContent = stats.totalEvents;
                    statCards[1].querySelector('.stat-number').textContent = stats.totalPeopleHelped;
                    statCards[2].querySelector('.stat-number').textContent = '85'; // Keep volunteers static for now
                }

                // Update recent activities
                if (stats.recentEvents && stats.recentEvents.length > 0) {
                    updateRecentActivities(stats.recentEvents);
                }
            } catch (error) {
                console.error('Error loading statistics:', error);
            }
        }

        // Update recent activities with real data
        function updateRecentActivities(events) {
            const activityList = document.querySelector('.activity-list');
            if (!activityList || events.length === 0) return;

            // Clear existing activities and add real ones
            activityList.innerHTML = '';
            
            events.slice(0, 5).forEach((event, index) => {
                const activityItem = document.createElement('div');
                activityItem.className = 'activity-item';
                
                const date = new Date(event.date).toLocaleDateString('ar-SA', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });

                activityItem.innerHTML = `
                    <h4>${event.title} ๐ฏ</h4>
                    <p>${event.description}</p>
                    <span class="activity-date">${date}</span>
                    <div class="activity-actions">
                        <a href="/dashboard/event/${event.id}" class="view-event-btn">ุนุฑุถ ุงูุชูุงุตูู</a>
                    </div>
                `;
                
                // Make the entire item clickable
                activityItem.style.cursor = 'pointer';
                activityItem.addEventListener('click', function(e) {
                    // Don't navigate if clicking on the button
                    if (!e.target.classList.contains('view-event-btn')) {
                        window.location.href = `/dashboard/event/${event.id}`;
                    }
                });
                
                activityList.appendChild(activityItem);
            });
        }

        // Logout confirmation
        function confirmLogout() {
            return confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุชุณุฌูู ุงูุฎุฑูุฌุ');
        }

        // Load statistics when page loads
        document.addEventListener('DOMContentLoaded', loadStatistics);

        // ุฅุถุงูุฉ ุชุฃุซูุฑุงุช ุชูุงุนููุฉ
        document.querySelectorAll('.stat-card').forEach(card => {
            card.addEventListener('mouseenter', () => {
                card.style.transform = 'translateY(-10px) scale(1.02)';
            });
            
            card.addEventListener('mouseleave', () => {
                card.style.transform = 'translateY(0) scale(1)';
            });
        });

        // ุชุญุฏูุซ ุงูููุช ุงูุญุงูู
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('ar-SA', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // ูููู ุฅุถุงูุฉ ุนูุตุฑ ูุนุฑุถ ุงูููุช ุฅุฐุง ุฃุฑุฏุช
            console.log('ุงูููุช ุงูุญุงูู:', timeString);
        }

        // ุชุญุฏูุซ ุงูููุช ูู ุฏูููุฉ
        setInterval(updateTime, 60000);
        updateTime(); // ุชุดุบูู ููุฑู

        // ุฅุถุงูุฉ ุชุฃุซูุฑุงุช ุนูู ุงูุฃุฒุฑุงุฑ
        document.querySelectorAll('.action-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                // ุฅุถุงูุฉ ุชุฃุซูุฑ ุงูููุฑ
                this.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                }, 150);
            });
        });

        // ุฅุถุงูุฉ ุชุฃุซูุฑ ุงูุชุญููู ููููุงุฐุฌ
        document.querySelectorAll('form').forEach(form => {
            form.addEventListener('submit', function() {
                const submitBtn = this.querySelector('button[type="submit"]');
                if (submitBtn) {
                    submitBtn.innerHTML = '<span class="loading"></span> ุฌุงุฑู ุงูุญูุธ...';
                    submitBtn.disabled = true;
                }
            });
        });
    </script>
</body>
</html>