<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© - Ø¬Ù…Ø¹ÙŠØ© Ø³ÙˆØ§Ø¹Ø¯ Ø´Ø¨Ø§Ø¨ Ù„ÙŠØ¨ÙŠØ§ Ø§Ù„Ø®ÙŠØ±ÙŠØ©</title>
  <!-- <link rel="stylesheet" href="/styles.css"> -->
  <link rel="stylesheet" href="/styles.css">
   <style>

   </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
  <header>
    <nav>
      <div class="logo">Ø¬Ù…Ø¹ÙŠØ© Ø³ÙˆØ§Ø¹Ø¯ Ø´Ø¨Ø§Ø¨ Ù„ÙŠØ¨ÙŠØ§ ğŸ’™</div>
      <ul>
        <li><a href="/">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
        <li><a href="/#activities">Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ ÙˆØ§Ù„Ø£Ù†Ø´Ø·Ø©</a></li>
        <li><a href="/#partner-organizations">Ø´Ø±ÙƒØ§Ø¦Ù†Ø§</a></li>
        <li><a href="/#about">Ù…Ù† Ù†Ø­Ù†</a></li>
        <li><a href="/login">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a></li>
      </ul>
    </nav>
  </header>
  <div id="d"></div>
  <main class="event-detail-main">
    <div class="container">
      <div class="loading-container" id="loading">
        <!-- <div class="loading"></div>
        <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©...</p> -->
      </div>

      <div class="event-detail-container hidden" id="eventDetail">
        <div class="event-hero">
          <div class="event-hero-content">
            <h1 id="eventTitle" class="event-title"></h1>
            <p class="event-intro">Ù‡Ù†Ø§ ØªØ¬Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡Ø°Ù‡ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„Ø®ÙŠØ±ÙŠØ© Ø§Ù„ØªÙŠ Ù†Ø¸Ù…ØªÙ‡Ø§ Ø§Ù„Ø¬Ù…Ø¹ÙŠØ© ğŸŒŸ</p>
            <div class="event-meta">
              <div class="meta-item">
                <i class="fas fa-calendar-alt"></i>
                <span id="eventDate"></span>
              </div>
              <div class="meta-item">
                <i class="fas fa-map-marker-alt"></i>
                <span id="eventLocation"></span>
              </div>
            </div>
          </div>
        </div>

        <div class="event-content">
          <div class="content-grid">
            <div class="main-content">
              <div class="event-images-section" id="eventImagesSection">
                <h2 class="section-title">
                  <i class="fas fa-images"></i>
                  ØµÙˆØ± Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©
                </h2>
                <div class="event-images" id="eventImages"></div>
              </div>

              <div class="event-description-section">
                <h2 class="section-title">
                  <i class="fas fa-file-alt"></i>
                  ÙˆØµÙ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©
                </h2>
                <div class="description-card">
                  <p class="event-description" id="eventDescription"></p>
                </div>
              </div>

              <div class="partners-section hidden" id="partnersSection">
                <h2 class="section-title">
                  <i class="fas fa-handshake"></i>
                  Ø§Ù„Ø´Ø±ÙƒØ§Ø¡ ÙˆØ§Ù„Ù…ØªØ¹Ø§ÙˆÙ†ÙˆÙ†
                </h2>
                <div class="partners-card">
                  <div class="partner-tags" id="eventPartners"></div>
                </div>
              </div>
            </div>

            <div class="sidebar-content">
              <div class="stats-card">
                <h3 class="card-title">
                  <i class="fas fa-chart-bar"></i>
                  Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©
                </h3>
                <div class="stats-grid">
                  <div class="stat-item">
                    <div class="stat-icon">
                      <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                      <span class="stat-label">Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ÙˆÙ†</span>
                      <span class="stat-value" id="eventPeopleHelped"></span>
                    </div>
                  </div>
                  <div class="stat-item">
                    <div class="stat-icon">
                      <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-info">
                      <span class="stat-label">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</span>
                      <span class="stat-value" id="eventBudget"></span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="info-card">
                <h3 class="card-title">
                  <i class="fas fa-info-circle"></i>
                  Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
                </h3>
                <div class="info-content">
                  <p class="added-by">
                    <i class="fas fa-user-plus"></i>
                    ØªÙ… Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¨ÙˆØ§Ø³Ø·Ø©: <span id="eventAddedBy"></span>
                  </p>
                </div>
              </div>
              
            </div>
          </div>
        </div>

        <div class="event-actions">
          <div class="actions-container">
            <a href="/" class="action-btn primary">
              <i class="fas fa-home"></i>
              Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            </a>
            <a href="/#activities" class="action-btn secondary">
              <i class="fas fa-list"></i>
              Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ø´Ø·Ø©
            </a>
          </div>
        </div>
      </div>

      <!-- <div class="error-container hidden" id="errorContainer">
        <div class="error-card">
          <div class="error-icon">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <h3>Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©</h3>
          <p id="errorMessage">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</p>
          <a href="/" class="action-btn primary">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        </div>
      </div> -->
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const eventId = window.location.pathname.split('/').pop();
      if (!eventId) {
        showError('Ù…Ø¹Ø±Ù Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­');
        return;
      }
      loadEventDetails(eventId);
    });

    async function loadEventDetails(eventId) {
      try {
        const response = await fetch(`/api/public/event/${eventId}`);
        if (!response.ok) throw new Error(response.status === 404 ? 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©' : 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©');
        const event = await response.json();
        displayEventDetails(event);
      } catch (error) {
        showError(error.message);
      }
    }

    function displayEventDetails(event) {
      document.getElementById('loading').classList.add('hidden');
      document.getElementById('eventDetail').classList.remove('hidden');

      document.getElementById('eventTitle').textContent = event.title;
      document.getElementById('eventDate').textContent = new Date(event.date).toLocaleDateString('ar-SA');
      document.getElementById('eventLocation').textContent = event.location;
      document.getElementById('eventDescription').textContent = event.description;
      document.getElementById('eventPeopleHelped').textContent = event.people_helped.toLocaleString('ar-SA');
      document.getElementById('eventBudget').textContent = event.budget > 0 ? `${event.budget.toLocaleString('ar-SA')} Ø±ÙŠØ§Ù„` : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
      document.getElementById('eventAddedBy').textContent = event.added_by;

      if (event.partners && event.partners.trim()) {
        document.getElementById('eventPartners').textContent = event.partners;
        document.getElementById('partnersSection').classList.remove('hidden');
      }

      displayEventImages(event.images || []);
    }

    function displayEventImages(images) {
      const container = document.getElementById('eventImages');
      if (!images.length) {
        container.innerHTML = '<div class="no-images">ğŸ“· Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ± Ù„Ù‡Ø°Ù‡ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©</div>';
        return;
      }
      container.innerHTML = `
        <div class="images-grid">
          ${images.map(img => `
            <div class="event-image-item">
              <img src="${img.path}" alt="${img.originalname}" onclick="openImageModal('${img.path}', '${img.originalname}')">
              
            </div>
          `).join('')}
        </div>`;
    }

    function openImageModal(imagePath, imageName) {
      const modal = document.createElement('div');
      modal.className = 'image-modal';
      modal.innerHTML = `
        <div class="modal-content">
          <span class="close-modal" onclick="closeImageModal()">&times;</span>
          <img src="${imagePath}" alt="${imageName}">
          <div class="modal-caption">${imageName}</div>
        </div>`;
      document.body.appendChild(modal);
      modal.style.display = 'flex';
    }

    function closeImageModal() {
      const modal = document.querySelector('.image-modal');
      if (modal) modal.remove();
    }

    function showError(message) {
      document.getElementById('loading').classList.add('hidden');
      document.getElementById('errorMessage').textContent = message;
      document.getElementById('errorContainer').classList.remove('hidden');
    }
  </script>
</body>

</html>
